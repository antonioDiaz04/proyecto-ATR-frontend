<main
  class="min-h-screen rounded-xl bg-gradient-to-br from-slate-50 via-white to-slate-100 dark:bg-mainOscuro transition-colors duration-300"
>
  <div
    class="flex-1 rounded-xl p-6 lg:p-8 space-y-8 max-w-screen-xl mx-auto dark:bg-mainOscuro"
  >
    <!-- Encabezado -->
    <div
      class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6"
    >
      <div class="space-y-4">
        <div>
          <h1
            class="text-3xl font-bold tracking-tight text-slate-900 dark:text-textoClaro"
          >
            Panel de Administración
          </h1>
          <p class="text-slate-600 dark:text-gray-400 mt-1">
            Atelier - Gestión de vestidos y clientes
          </p>
        </div>

        <!-- Filtros -->
        <div class="flex flex-wrap gap-2">
          <button
            (click)="filtrarPor('semana')"
            [ngClass]="{
              'bg-slate-900 text-white shadow-md hover:bg-slate-800 dark:bg-acento dark:hover:bg-acentoHover': filtroActivo === 'semana',
              'bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 dark:bg-[#1F2937] dark:text-gray-300 dark:border-gray-600 dark:hover:bg-[#2a2a2a]': filtroActivo !== 'semana'
            }"
            class="px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 capitalize"
          >
            Semana
          </button>
          <button
            (click)="filtrarPor('quincena')"
            [ngClass]="{
              'bg-slate-900 text-white shadow-md hover:bg-slate-800 dark:bg-acento dark:hover:bg-acentoHover': filtroActivo === 'quincena',
              'bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 dark:bg-[#1F2937] dark:text-gray-300 dark:border-gray-600 dark:hover:bg-[#2a2a2a]': filtroActivo !== 'quincena'
            }"
            class="px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 capitalize"
          >
            Quincena
          </button>
          <button
            (click)="filtrarPor('mes')"
            [ngClass]="{
              'bg-slate-900 text-white shadow-md hover:bg-slate-800 dark:bg-acento dark:hover:bg-acentoHover': filtroActivo === 'mes',
              'bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 dark:bg-[#1F2937] dark:text-gray-300 dark:border-gray-600 dark:hover:bg-[#2a2a2a]': filtroActivo !== 'mes'
            }"
            class="px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 capitalize"
          >
            Mes
          </button>
          <button
            (click)="filtrarPor('anio')"
            [ngClass]="{
              'bg-slate-900 text-white shadow-md hover:bg-slate-800 dark:bg-acento dark:hover:bg-acentoHover': filtroActivo === 'anio',
              'bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 dark:bg-[#1F2937] dark:text-gray-300 dark:border-gray-600 dark:hover:bg-[#2a2a2a]': filtroActivo !== 'anio'
            }"
            class="px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 capitalize"
          >
            Año
          </button>
        </div>
      </div>

      <!-- Barra de búsqueda y perfil -->
      <div class="flex items-center gap-4">
        <div class="relative">
          <svg
            class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-300 h-4 w-4"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"
            ></path>
          </svg>
          <input
            type="text"
            placeholder="Buscar vestidos, clientes..."
            class="pl-10 pr-4 py-2.5 text-sm border border-slate-200 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-400 dark:focus:ring-gray-400 focus:border-slate-400 dark:focus:border-gray-400 bg-white dark:bg-[#1F2937] text-gray-800 dark:text-gray-100 w-80 transition-all duration-200"
          />
        </div>
        <div
          class="w-10 h-10 bg-gradient-to-br from-slate-200 to-slate-300 dark:from-[#2a2a2a] dark:to-[#3a3a3a] rounded-full flex items-center justify-center ring-2 ring-slate-200 dark:ring-gray-600"
        >
          <span class="text-slate-600 dark:text-gray-100 font-medium text-sm"
            >AD</span
          >
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Ingresos Totales -->
      <div class="card-container" (click)="toggleCard('ingresos')">
        <div class="card-inner" [class.card-flipped]="cardFlipped.ingresos">
          <div
            class="bg-gradient-to-br from-emerald-50 to-emerald-100/50 dark:from-emerald-900 dark:to-emerald-800 p-6 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-200 hover:-translate-y-1 border border-emerald-100 dark:border-emerald-700"
          >
            <h4
              class="text-sm font-medium text-emerald-700 dark:text-emerald-300"
            >
              Ingresos Totales
            </h4>
            <p
              class="text-2xl font-bold text-emerald-900 dark:text-emerald-100 mb-1"
            >
              ${{ totalRentaVentas | number:'1.0-2' }}
            </p>
            <p class="text-xs text-emerald-600 dark:text-emerald-400">
              {{ crecimientoRentaVentas >= 0 ? '+' : '' }}{{
              crecimientoRentaVentas }}% vs período anterior
            </p>
          </div>
          <div
            class="card-back bg-gradient-to-br from-emerald-50 to-emerald-100/50 dark:from-emerald-900 dark:to-emerald-800 p-6 rounded-2xl shadow-sm border border-emerald-100 dark:border-emerald-700"
          >
            <h4
              class="text-sm font-medium text-emerald-700 dark:text-emerald-300"
            >
              Ingresos Anteriores
            </h4>
            <p
              class="text-2xl font-bold text-emerald-900 dark:text-emerald-100 mb-1"
            >
              ${{ montoTotalAnterior | number:'1.0-2' }}
            </p>
            <p class="text-xs text-emerald-600 dark:text-emerald-400">
              Período anterior
            </p>
          </div>
        </div>
      </div>

      <!-- Vestidos Rentados -->
      <div class="card-container" (click)="toggleCard('rentas')">
        <div class="card-inner" [class.card-flipped]="cardFlipped.rentas">
          <div
            class="bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900 dark:to-blue-800 p-6 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-200 hover:-translate-y-1 border border-blue-100 dark:border-blue-700"
          >
            <h4 class="text-sm font-medium text-blue-700 dark:text-blue-300">
              Vestidos Rentados
            </h4>
            <p class="text-2xl font-bold text-blue-900 dark:text-blue-100 mb-1">
              {{ totalRentas }}
            </p>
            <p class="text-xs text-blue-600 dark:text-blue-400">
              {{ crecimientoRentas >= 0 ? '+' : '' }}{{ crecimientoRentas }}% vs
              período anterior
            </p>
          </div>
          <div
            class="card-back bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900 dark:to-blue-800 p-6 rounded-2xl shadow-sm border border-blue-100 dark:border-blue-700"
          >
            <h4 class="text-sm font-medium text-blue-700 dark:text-blue-300">
              Rentas Anteriores
            </h4>
            <p class="text-2xl font-bold text-blue-900 dark:text-blue-100 mb-1">
              {{ totalRentasAnterior }}
            </p>
            <p class="text-xs text-blue-600 dark:text-blue-400">
              Período anterior
            </p>
          </div>
        </div>
      </div>

      <!-- Vestidos Vendidos -->
      <div class="card-container" (click)="toggleCard('ventas')">
        <div class="card-inner" [class.card-flipped]="cardFlipped.ventas">
          <div
            class="bg-gradient-to-br from-purple-50 to-purple-100/50 dark:from-purple-900 dark:to-purple-800 p-6 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-200 hover:-translate-y-1 border border-purple-100 dark:border-purple-700"
          >
            <h4
              class="text-sm font-medium text-purple-700 dark:text-purple-300"
            >
              Vestidos Vendidos
            </h4>
            <p
              class="text-2xl font-bold text-purple-900 dark:text-purple-100 mb-1"
            >
              {{ totalVentas }}
            </p>
            <p class="text-xs text-purple-600 dark:text-purple-400">
              {{ crecimientoVentas >= 0 ? '+' : '' }}{{ crecimientoVentas }}% vs
              período anterior
            </p>
          </div>
          <div
            class="card-back bg-gradient-to-br from-purple-50 to-purple-100/50 dark:from-purple-900 dark:to-purple-800 p-6 rounded-2xl shadow-sm border border-purple-100 dark:border-purple-700"
          >
            <h4
              class="text-sm font-medium text-purple-700 dark:text-purple-300"
            >
              Ventas Anteriores
            </h4>
            <p
              class="text-2xl font-bold text-purple-900 dark:text-purple-100 mb-1"
            >
              {{ totalVentasAnterior }}
            </p>
            <p class="text-xs text-purple-600 dark:text-purple-400">
              Período anterior
            </p>
          </div>
        </div>
      </div>

      <!-- Clientes Nuevos -->
      <div class="card-container" (click)="toggleCard('clientes')">
        <div class="card-inner" [class.card-flipped]="cardFlipped.clientes">
          <div
            class="bg-gradient-to-br from-orange-50 to-orange-100/50 dark:from-orange-900 dark:to-orange-800 p-6 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-200 hover:-translate-y-1 border border-orange-100 dark:border-orange-700"
          >
            <h4
              class="text-sm font-medium text-orange-700 dark:text-orange-300"
            >
              Clientes Nuevos
            </h4>
            <p
              class="text-2xl font-bold text-orange-900 dark:text-orange-100 mb-1"
            >
              {{ totalClientes }}
            </p>
            <p class="text-xs text-orange-600 dark:text-orange-400">
              {{ crecimientoClientes >= 0 ? '+' : '' }}{{ crecimientoClientes
              }}% vs período anterior
            </p>
          </div>
          <div
            class="card-back bg-gradient-to-br from-orange-50 to-orange-100/50 dark:from-orange-900 dark:to-orange-800 p-6 rounded-2xl shadow-sm border border-orange-100 dark:border-orange-700"
          >
            <h4
              class="text-sm font-medium text-orange-700 dark:text-orange-300"
            >
              Clientes Anteriores
            </h4>
            <p
              class="text-2xl font-bold text-orange-900 dark:text-orange-100 mb-1"
            >
              {{ totalClientesAnterior }}
            </p>
            <p class="text-xs text-orange-600 dark:text-orange-400">
              Período anterior
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <!-- Gráfica de barras -->
      <div
        class="md:col-span-2 bg-white dark:bg-fondoTarjeta p-5 rounded-2xl shadow-sm hover:shadow-md transition hover:scale-[1.01]"
      >
        <h3
          class="text-base font-semibold text-gray-700 dark:text-gray-100 mb-3"
        >
          Ingresos por Renta y Venta
        </h3>
        <div class="relative w-full aspect-[2/1]">
          <apx-chart
            *ngIf="chartOptionsApex && chartOptionsApex.series && chartOptionsApex.chart && chartOptionsApex.xaxis && hayDatosEnGrafica"
            [series]="chartOptionsApex.series"
            [chart]="chartOptionsApex.chart"
            [xaxis]="chartOptionsApex.xaxis"
            [colors]="chartOptionsApex.colors || []"
            [dataLabels]="chartOptionsApex.dataLabels || {}"
            [plotOptions]="chartOptionsApex.plotOptions || {}"
            [stroke]="chartOptionsApex.stroke || {}"
            [tooltip]="chartOptionsApex.tooltip || {}"
            [fill]="chartOptionsApex.fill || {}"
            [markers]="chartOptionsApex.markers || {}"
            [legend]="chartOptionsApex.legend || {}"
            [grid]="chartOptionsApex.grid || {}"
            [title]="chartOptionsApex.title || {}"
            class="w-full h-[300px]"
          ></apx-chart>

          <div
            *ngIf="!hayDatosEnGrafica"
            class="flex flex-col items-center justify-center h-[300px] text-gray-500 dark:text-gray-400 text-sm border rounded-xl space-y-3 border-gray-200 dark:border-gray-600 bg-white dark:bg-[#111827]"
          >
            <img
              src="https://cdn-icons-png.flaticon.com/512/4076/4076503.png"
              alt="Sin datos"
              class="w-16 h-16 opacity-60"
            />
            <p class="italic">No hay datos disponibles para este periodo.</p>
          </div>
        </div>
      </div>

      <!-- Calendario de Rentas -->
      <div
        class="bg-white dark:bg-fondoTarjeta p-6 rounded-2xl shadow-md transition hover:shadow-lg hover:scale-[1.01]"
      >
        <!-- Título y mes -->
        <div class="flex items-center justify-between mb-4">
          <h3
            class="text-xl font-semibold text-gray-800 dark:text-textoClaro tracking-tight flex items-center gap-2"
          >
            <svg
              class="w-5 h-5 text-blue-600 dark:text-blue-400"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z"
              />
            </svg>
            Calendario de Rentas
          </h3>
          <span
            class="text-sm font-medium text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900 px-3 py-1 rounded-full shadow"
          >
            {{ mesAnioActual }}
          </span>
        </div>

        <!-- Controles -->
        <div class="flex items-center justify-between mb-4">
          <div class="flex gap-2">
            <button
              class="px-4 py-1.5 text-sm bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-800 border border-blue-200 dark:border-blue-700 rounded-md transition"
              (click)="irAnterior()"
            >
              ← Anterior
            </button>
            <button
              class="px-4 py-1.5 text-sm bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-800 border border-blue-200 dark:border-blue-700 rounded-md transition"
              (click)="irHoy()"
            >
              Hoy
            </button>
            <button
              class="px-4 py-1.5 text-sm bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-800 border border-blue-200 dark:border-blue-700 rounded-md transition"
              (click)="irSiguiente()"
            >
              Siguiente →
            </button>
          </div>
        </div>

        <!-- Contenedor del calendario -->
        <div
          id="tui-calendar-container"
          class="w-full h-[350px] rounded-xl border border-blue-100 dark:border-blue-700 shadow-inner overflow-hidden bg-white dark:bg-fondoOscuro transition-colors"
        ></div>
      </div>
    </div>

    <!-- Tabla de transacciones mejorada -->
    <div
      class="bg-white dark:bg-fondoOscuro rounded-3xl shadow-xl border border-gray-100/50 dark:border-bordeOscuro overflow-hidden backdrop-blur-sm"
    >
      <!-- Header con gradiente -->
      <div
        class="bg-gradient-to-r from-gray-50 via-white to-gray-50 dark:from-[#1c1d1f] dark:via-[#202123] dark:to-[#1c1d1f] p-8 border-b border-gray-100 dark:border-bordeOscuro"
      >
        <div class="flex items-center justify-between">
          <div class="space-y-2">
            <div class="flex items-center gap-3">
              <div
                class="w-2 h-8 bg-gradient-to-b from-blue-500 to-purple-600 rounded-full"
              ></div>
              <h3
                class="text-2xl font-bold text-gray-900 dark:text-textoClaro tracking-tight"
              >
                Últimas Transacciones
              </h3>
            </div>
            <p
              class="text-gray-600 dark:text-gray-300 text-sm font-medium flex items-center gap-2"
            >
              <svg
                class="w-4 h-4 text-gray-400"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                ></path>
              </svg>
              Historial reciente de rentas y ventas • {{ transacciones.length }}
              transacciones
            </p>
          </div>
          <div class="flex items-center gap-3">
            <button
              *ngIf="!mostrarTodas && transacciones.length > tamanoPagina"
              (click)="verTodasLasTransacciones()"
              class="group relative px-6 py-3 text-sm font-semibold rounded-xl transition-all duration-300 bg-gray-900 text-white shadow-lg hover:shadow-xl hover:bg-gray-800 transform hover:-translate-y-0.5"
            >
              <svg
                class="w-4 h-4 mr-2 inline-block"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                ></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                ></path>
              </svg>
              Ver todas ({{ transacciones.length }})
            </button>
            <button
              *ngIf="mostrarTodas"
              (click)="reiniciarPaginacion()"
              class="px-6 py-3 text-sm font-semibold rounded-xl transition-all duration-300 bg-white border-2 border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 shadow-sm hover:shadow-md"
            >
              <svg
                class="w-4 h-4 mr-2 inline-block"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
              Ver menos
            </button>
          </div>
        </div>
      </div>

      <!-- Tabla -->
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr
              class="bg-gradient-to-r from-gray-50 to-gray-100/50 dark:from-[#1f1f20] dark:to-[#2c2c2e] border-b border-gray-200 dark:border-bordeOscuro"
            >
              <th
                (click)="ordenarPor('cliente')"
                class="group cursor-pointer dark:text-textoClaro text-left py-5 px-8 text-sm font-bold text-gray-700 hover:text-gray-900 transition-all duration-200 select-none"
              >
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-gray-500"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                    ></path>
                  </svg>
                  Cliente
                  <svg
                    class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19 9l-7 7-7-7"
                    ></path>
                  </svg>
                </div>
              </th>
              <th
                (click)="ordenarPor('tipo')"
                class="group cursor-pointer dark:text-textoClaro text-left py-5 px-8 text-sm font-bold text-gray-700 hover:text-gray-900 transition-all duration-200 select-none"
              >
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-gray-500"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
                    ></path>
                  </svg>
                  Tipo
                  <svg
                    class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19 9l-7 7-7-7"
                    ></path>
                  </svg>
                </div>
              </th>
              <th
                (click)="ordenarPor('vestido')"
                class="group cursor-pointer dark:text-textoClaro text-left py-5 px-8 text-sm font-bold text-gray-700 hover:text-gray-900 transition-all duration-200 select-none"
              >
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-gray-500"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
                    ></path>
                  </svg>
                  Vestido
                  <svg
                    class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19 9l-7 7-7-7"
                    ></path>
                  </svg>
                </div>
              </th>
              <th
                (click)="ordenarPor('monto')"
                class="group cursor-pointer dark:text-textoClaro text-left py-5 px-8 text-sm font-bold text-gray-700 hover:text-gray-900 transition-all duration-200 select-none"
              >
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-gray-500"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"
                    ></path>
                  </svg>
                  Monto
                  <svg
                    class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19 9l-7 7-7-7"
                    ></path>
                  </svg>
                </div>
              </th>
              <th
                (click)="ordenarPor('estado')"
                class="group cursor-pointer dark:text-textoClaro text-left py-5 px-8 text-sm font-bold text-gray-700 hover:text-gray-900 transition-all duration-200 select-none"
              >
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-gray-500"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                  Estado
                  <svg
                    class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19 9l-7 7-7-7"
                    ></path>
                  </svg>
                </div>
              </th>
              <th
                (click)="ordenarPor('fecha')"
                class="group cursor-pointer dark:text-textoClaro text-left py-5 px-8 text-sm font-bold text-gray-700 hover:text-gray-900 transition-all duration-200 select-none"
              >
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-gray-500"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                    ></path>
                  </svg>
                  Período
                  <svg
                    class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19 9l-7 7-7-7"
                    ></path>
                  </svg>
                </div>
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let transaccion of transaccionesPaginadas; trackBy: trackByTransaccion; let i = index"
              class="group hover:bg-gradient-to-r hover:from-gray-50/50 hover:to-blue-50/30 transition-all duration-300 hover:shadow-sm"
              [style.animation-delay]="i * 50 + 'ms'"
            >
              <!-- Cliente -->
              <td
                class="py-6 px-8 text-base text-gray-800 dark:text-textoClaro"
              >
                <div class="flex items-center gap-4">
                  <div class="relative">
                    <div
                      class="w-12 h-12 rounded-full overflow-hidden flex items-center justify-center bg-gradient-to-br from-blue-100 to-purple-100 border-2 border-white shadow-lg group-hover:shadow-xl transition-all duration-300 group-hover:scale-105"
                    >
                      <ng-container
                        *ngIf="transaccion.fotoDePerfil; else sinFoto"
                      >
                        <img
                          [src]="transaccion.fotoDePerfil"
                          [alt]="'Foto de ' + transaccion.cliente"
                          class="w-full h-full object-cover"
                        />
                      </ng-container>
                      <ng-template #sinFoto>
                        <span
                          class="text-base font-bold text-gray-800 dark:text-white"
                        >
                          {{ getInitials(transaccion.cliente) }}
                        </span>
                      </ng-template>
                    </div>
                    <div
                      class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-white"
                    ></div>
                  </div>
                  <div>
                    <span
                      class="font-semibold text-gray-900 dark:text-white text-base block tracking-wide"
                    >
                      {{ transaccion.cliente }}
                    </span>
                    <span
                      class="text-sm text-gray-600 dark:text-gray-400 font-medium tracking-normal"
                    >
                      Cliente activo
                    </span>
                  </div>
                </div>
              </td>

              <!-- Tipo -->
              <td class="py-6 px-8 text-blue-700 dark:text-blue-300 text-base">
                <div class="flex items-center gap-2">
                  <div
                    class="w-2.5 h-2.5 rounded-full"
                    [ngClass]="{
        'bg-blue-500': transaccion.tipo === 'Renta',
        'bg-purple-500': transaccion.tipo === 'Venta'
      }"
                  ></div>
                  <span
                    class="inline-flex items-center gap-1.5 px-3 py-2 rounded-full text-sm font-semibold border-0 shadow-sm transition-all duration-200 hover:shadow-md tracking-wide"
                    [ngClass]="{
        'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800': transaccion.tipo === 'Renta',
        'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200 hover:bg-purple-200 dark:hover:bg-purple-800': transaccion.tipo === 'Venta'
      }"
                  >
                    <svg
                      *ngIf="transaccion.tipo === 'Renta'"
                      class="w-4 h-4"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M7 16l-4-4m0 0l4-4m-4 4h18"
                      ></path>
                    </svg>
                    <svg
                      *ngIf="transaccion.tipo === 'Venta'"
                      class="w-4 h-4"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M17 8l4 4m0 0l-4 4m4-4H3"
                      ></path>
                    </svg>
                    {{ transaccion.tipo }}
                  </span>
                </div>
              </td>

              <!-- Vestido -->
              <td class="py-6 px-8 text-base text-gray-800 dark:text-gray-200">
                <div class="flex items-center gap-3">
                  <div
                    class="w-9 h-9 bg-gradient-to-br from-pink-100 to-rose-100 dark:from-rose-900 dark:to-pink-900 rounded-lg flex items-center justify-center"
                  >
                    <svg
                      class="w-5 h-5 text-pink-600 dark:text-pink-300"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
                      ></path>
                    </svg>
                  </div>
                  <span
                    class="text-base font-semibold tracking-wide dark:text-gray-100"
                  >
                    {{ transaccion.vestido }}
                  </span>
                </div>
              </td>

              <!-- Monto -->
              <td class="py-6 px-8 text-base text-gray-800 dark:text-gray-200">
                <div class="flex items-center gap-3">
                  <div
                    class="w-10 h-10 bg-gradient-to-br from-green-100 to-emerald-100 dark:from-emerald-900 dark:to-green-900 rounded-lg flex items-center justify-center"
                  >
                    <svg
                      class="w-5 h-5 text-green-600 dark:text-emerald-300"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"
                      ></path>
                    </svg>
                  </div>
                  <span class="text-xl tracking-tight dark:text-gray-100">
                    ${{ transaccion.monto | number:'1.2-2' }}
                  </span>
                </div>
              </td>

              <!-- Estado -->
              <td
                class="py-6 px-8 text-base text-emerald-700 dark:text-emerald-400"
              >
                <span
                  class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-semibold text-base shadow-md transition-all duration-200"
                  [ngClass]="{
      'bg-emerald-100 text-emerald-800 hover:bg-emerald-200 dark:bg-emerald-900 dark:text-emerald-200': transaccion.estado === 'Pagado',
      'bg-amber-100 text-amber-800 hover:bg-amber-200 dark:bg-amber-900 dark:text-amber-200': transaccion.estado === 'Pendiente',
      'bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900 dark:text-red-200': transaccion.estado === 'Cancelado'
    }"
                >
                  <div
                    class="w-2.5 h-2.5 rounded-full"
                    [ngClass]="{
        'bg-emerald-500': transaccion.estado === 'Pagado',
        'bg-amber-500': transaccion.estado === 'Pendiente',
        'bg-red-500': transaccion.estado === 'Cancelado'
      }"
                  ></div>
                  {{ transaccion.estado }}
                </span>
              </td>

              <!-- Período -->
              <td class="py-6 px-8 text-base text-gray-700 dark:text-gray-300">
                <div class="flex items-center gap-4">
                  <div
                    class="w-9 h-9 bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900 dark:to-indigo-900 rounded-lg flex items-center justify-center shadow-sm"
                  >
                    <svg
                      class="w-5 h-5 text-blue-600 dark:text-blue-300"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                      ></path>
                    </svg>
                  </div>
                  <div>
                    <span
                      class="block text-sm font-semibold text-gray-800 dark:text-gray-100"
                    >
                      {{ fechaInicio | date:'dd MMM' }} — {{ fechaFin |
                      date:'ddMMM yyyy' }}
                    </span>
                    <span
                      class="text-xs text-gray-500 dark:text-gray-400 font-medium"
                    >
                      Período de servicio
                    </span>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- Botón cargar más mejorado -->
        <div
          class="text-center py-8 bg-gradient-to-r from-gray-50/30 to-blue-50/20 border-t border-gray-100"
          *ngIf="!mostrarTodas && transaccionesPaginadas.length < transaccionesFiltradas.length"
        >
          <button
            (click)="cargarMas()"
            class="group px-8 py-4 bg-white hover:bg-gray-50 border-2 border-gray-200 hover:border-gray-300 text-gray-700 text-sm font-semibold rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 transform hover:-translate-y-0.5"
          >
            <svg
              class="w-4 h-4 mr-2 inline-block group-hover:animate-bounce"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19 14l-7 7m0 0l-7-7m7 7V3"
              ></path>
            </svg>
            Cargar más transacciones
            <span class="ml-2 text-xs text-gray-500">
              ({{ transaccionesPaginadas.length }} de {{
              transaccionesFiltradas.length }})
            </span>
          </button>
        </div>

        <!-- Estado vacío mejorado -->
        <div
          *ngIf="transaccionesFiltradas.length === 0"
          class="text-center py-16 bg-gradient-to-br from-gray-50 to-blue-50/30 dark:from-mainOscuro dark:to-fondoOscuro transition-colors"
        >
          <div
            class="w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-[#2a2a2a] dark:to-[#3a3a3a] rounded-full flex items-center justify-center mx-auto mb-6"
          >
            <svg
              class="w-10 h-10 text-gray-400 dark:text-gray-500"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"
              ></path>
            </svg>
          </div>
          <h4
            class="text-lg font-semibold text-gray-900 dark:text-textoClaro mb-2"
          >
            No se encontraron transacciones
          </h4>
          <p class="text-gray-500 dark:text-gray-400 font-medium mb-1">
            {{ terminoBusqueda ? 'Intenta con otros términos de búsqueda' : 'No
            hay transacciones para este período' }}
          </p>
          <p class="text-sm text-gray-400 dark:text-gray-500">
            Las transacciones aparecerán aquí una vez que se registren
          </p>
        </div>
      </div>
    </div>
  </div>
</main>
