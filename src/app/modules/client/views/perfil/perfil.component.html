<section class=" p-8 rounded-lg w-full max-w-full ">
  <header class="mb-8 text-start border-b border-gray-100 pb-6">
    <h1 class="text-3xl font-semibold text-gray-800 mb-2">Editar Perfil</h1>
    <p class="text-gray-500 text-sm leading-relaxed">
      Actualiza tu información personal y gestiona tus preferencias. Tus datos se mantienen seguros.
    </p>
  </header>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
    <div class="lg:col-span-2">
      <section class="flex flex-col md:flex-row items-center md:items-start mb-10 gap-8">
        <figure class="relative flex-shrink-0">
          <p-avatar
            *ngIf="!profileImg"
            [label]="getInitials(data.nombre)"
            styleClass="mr-2"
            size="xlarge"
            shape="circle"
            class="border-2 border-gray-200 shadow-sm transition-shadow duration-200 hover:shadow-md"
          ></p-avatar>
          <p-avatar
            *ngIf="profileImg"
            [image]="profileImg"
            styleClass="mr-2"
            size="xlarge"
            shape="circle"
            class="border-2 border-gray-200 shadow-sm transition-shadow duration-200 hover:shadow-md"
          ></p-avatar>
          <figcaption class="absolute -bottom-1 -right-1 bg-white rounded-full p-2 border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200">
            <label for="file-upload" class="cursor-pointer flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </label>
            <input id="file-upload" type="file" (change)="onFileChange($event)" class="hidden"/>
          </figcaption>
        </figure>

        <section class="flex-grow">
          <h3 class="font-medium text-gray-800 text-lg mb-1">{{ data.nombre }}</h3>
          <p class="text-gray-500 text-sm mb-1">Miembro desde: <span class="font-medium">{{ data.fechaRegistro | date:'longDate' }}</span></p>
          <p class="text-gray-500 text-sm">Última actualización: <span class="font-medium">{{ data.ultimaActualizacion | date:'medium' }}</span></p>
        </section>
      </section>

      <form class="perfil-form text-start">
        <section class="mb-10 pb-8 border-b border-gray-100">
          <h3 class="text-xl font-semibold text-gray-700 mb-6">Información de Contacto</h3>
          <section class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
            <div>
              <label for="nombre" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Nombre Completo</label>
              <input
                type="text"
                id="nombre"
                [value]="data.nombre"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="email" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Correo Electrónico</label>
              <input
                type="email"
                id="email"
                [value]="data.email"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="telefono" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Teléfono</label>
              <input
                type="tel"
                id="telefono"
                [value]="data.telefono"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="fechaNacimiento" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Fecha de Nacimiento</label>
              <input
                type="date"
                id="fechaNacimiento"
                [value]="data.fechaNacimiento | date:'yyyy-MM-dd'"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
          </section>
        </section>

        <!-- <section class="mb-10 pb-8 border-b border-gray-100">
          <h3 class="text-xl font-semibold text-gray-700 mb-6">Dirección de Envío</h3>
          <section class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
            <div>
              <label for="calle" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Calle y Número</label>
              <input
                type="text"
                id="calle"
                [value]="data.direccion?.calle || ''"
                placeholder="Ej: Av. Siempre Viva 742"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="ciudad" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Ciudad</label>
              <input
                type="text"
                id="ciudad"
                [value]="data.direccion?.ciudad || ''"
                placeholder="Ej: Ciudad de México"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="estado" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Estado / Región</label>
              <input
                type="text"
                id="estado"
                [value]="data.direccion?.estado || ''"
                placeholder="Ej: Jalisco"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="codigoPostal" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">Código Postal</label>
              <input
                type="text"
                id="codigoPostal"
                [value]="data.direccion?.codigoPostal || ''"
                placeholder="Ej: 44100"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
            <div>
              <label for="pais" class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wide">País</label>
              <input
                type="text"
                id="pais"
                [value]="data.direccion?.pais || 'México'"
                placeholder="Ej: México"
                class="w-full border-b border-gray-200 pb-2 px-0 text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-500 text-base transition-colors duration-200"
              />
            </div>
          </section>
        </section> -->

        <section class="mb-10 pb-8 border-b border-gray-100">
          <h3 class="text-xl font-semibold text-gray-700 mb-6">Notificaciones y Preferencias</h3>
          <div class="space-y-4">
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-md border border-gray-100">
              <div class="flex items-center gap-4">
                <p-avatar icon="pi pi-envelope" styleClass="bg-blue-100 text-blue-600" shape="circle"></p-avatar>
                <div>
                  <p class="text-gray-800 font-medium text-sm">Notificaciones por Correo</p>
                  <p class="text-gray-500 text-xs">Recibe actualizaciones importantes y novedades.</p>
                </div>
              </div>
              <button
                (click)="toggleEmailNotifications()"
                [ngClass]="{ 'bg-blue-600': data.preferencias?.notificacionesEmail, 'bg-gray-200': !data.preferencias?.notificacionesEmail }"
                class="relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                <span class="sr-only">Activar notificaciones por correo</span>
                <span
                  [ngClass]="{ 'translate-x-6': data.preferencias?.notificacionesEmail, 'translate-x-1': !data.preferencias?.notificacionesEmail }"
                  class="inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition-transform duration-200 ease-in-out"
                ></span>
              </button>
            </div>
            <div class="flex items-center p-4 bg-gray-50 rounded-md border border-gray-100">
              <input id="ofertasEspeciales" type="checkbox" [checked]="data.preferencias?.ofertasEspeciales"
                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
              <label for="ofertasEspeciales" class="ml-3 text-sm text-gray-700 cursor-pointer flex-grow">
                Recibir ofertas y promociones especiales
              </label>
            </div>
          </div>
        </section>

        <section class="mb-10 pb-8 border-b border-gray-100">
          <h3 class="text-xl font-semibold text-gray-700 mb-6">Sincronizar Cuentas</h3>
          <div class="space-y-4">
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-md border border-gray-100">
              <div class="flex items-center gap-4">
                <img src="assets/icons/google-logo.png" alt="Google Logo" class="h-6 w-6">
                <div>
                  <p class="text-gray-800 font-medium text-sm">Cuenta de Google</p>
                  <p class="text-gray-500 text-xs">Sincroniza tus datos de Google (ej: Gmail para notificaciones)</p>
                </div>
              </div>
              <button class="px-4 py-2 border border-blue-300 text-blue-600 rounded-md hover:bg-blue-50 transition-colors text-xs font-medium">
                {{ data.cuentasSincronizadas?.google ? 'Desconectar' : 'Conectar' }}
              </button>
            </div>
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-md border border-gray-100">
              <div class="flex items-center gap-4">
                <img src="assets/icons/facebook-logo.png" alt="Facebook Logo" class="h-6 w-6">
                <div>
                  <p class="text-gray-800 font-medium text-sm">Cuenta de Facebook</p>
                  <p class="text-gray-500 text-xs">Conecta para compartir actividades y encontrar amigos.</p>
                </div>
              </div>
              <button class="px-4 py-2 border border-blue-300 text-blue-600 rounded-md hover:bg-blue-50 transition-colors text-xs font-medium">
                {{ data.cuentasSincronizadas?.facebook ? 'Desconectar' : 'Conectar' }}
              </button>
            </div>
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-md border border-gray-100">
              <div class="flex items-center gap-4">
                <img src="assets/icons/paypal-logo.png" alt="PayPal Logo" class="h-6 w-6">
                <div>
                  <p class="text-gray-800 font-medium text-sm">Cuenta de PayPal</p>
                  <p class="text-gray-500 text-xs">Facilita tus pagos futuros y reembolsos.</p>
                </div>
              </div>
              <button class="px-4 py-2 border border-blue-300 text-blue-600 rounded-md hover:bg-blue-50 transition-colors text-xs font-medium">
                {{ data.cuentasSincronizadas?.paypal ? 'Desconectar' : 'Conectar' }}
              </button>
            </div>
          </div>
        </section>

        <section class="mb-8">
          <h3 class="text-xl font-semibold text-gray-700 mb-6">Seguridad y Cuenta</h3>
          <div class="space-y-4">
            <button
              type="button"
              class="w-full flex items-center justify-between px-5 py-3 border border-gray-200 text-gray-700 rounded-md hover:bg-gray-50 transition-colors duration-200 text-sm font-medium"
            >
              <span>Cambiar Contraseña</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
              </svg>
            </button>
            <button
              type="button"
              class="w-full flex items-center justify-between px-5 py-3 border border-gray-200 text-gray-700 rounded-md hover:bg-gray-50 transition-colors duration-200 text-sm font-medium"
            >
              <span>Ver Historial de Pedidos</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
              </svg>
            </button>
          </div>
        </section>

        <section class="flex flex-col sm:flex-row justify-end gap-3 pt-6 border-t border-gray-100">
          <button
            type="button"
            (click)="logout()"
            class="px-6 py-2 border border-red-300 text-red-600 rounded-md hover:bg-red-50 transition-colors duration-200 text-sm font-medium"
          >
            Cerrar sesión
          </button>
          <button
            type="button"
            class="px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 transition-colors duration-200 text-sm font-medium"
          >
            Cancelar
          </button>
          <button
            type="submit"
            class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200 text-sm font-medium shadow-sm"
          >
            Guardar Cambios
          </button>
        </section>
      </form>
    </div>

    <div class="lg:col-span-1">
      <section class="mb-10 p-6 bg-white rounded-md shadow-sm ">
        <h3 class="text-xl font-semibold text-gray-700 mb-6">Tu Actividad Resumen</h3>
        <div class="grid grid-cols-1 gap-6">
          <div class="bg-blue-50 p-6 rounded-md shadow-sm border border-blue-100 flex flex-col items-start">
            <p-avatar icon="pi pi-shopping-cart" styleClass="bg-blue-200 text-blue-700 mb-3" shape="circle" size="normal"></p-avatar>
            <p class="text-gray-600 text-sm mb-1">Compras Realizadas</p>
            <p class="text-2xl font-bold text-blue-800">{{ data.resumen?.comprasTotales || 0 }}</p>
            <a href="#" class="text-blue-600 text-xs mt-2 hover:underline">Ver historial</a>
          </div>
          <div class="bg-green-50 p-6 rounded-md shadow-sm border border-green-100 flex flex-col items-start">
            <p-avatar icon="pi pi-box" styleClass="bg-green-200 text-green-700 mb-3" shape="circle" size="normal"></p-avatar>
            <p class="text-gray-600 text-sm mb-1">Productos en Renta</p>
            <p class="text-2xl font-bold text-green-800">{{ data.resumen?.rentasActivas || 0 }}</p>
            <a href="#" class="text-green-600 text-xs mt-2 hover:underline">Gestionar rentas</a>
          </div>
          <div class="bg-yellow-50 p-6 rounded-md shadow-sm border border-yellow-100 flex flex-col items-start">
            <p-avatar icon="pi pi-bell" styleClass="bg-yellow-200 text-yellow-700 mb-3" shape="circle" size="normal"></p-avatar>
            <p class="text-gray-600 text-sm mb-1">Notificaciones / Reseñas</p>
            <p class="text-2xl font-bold text-yellow-800">{{ data.resumen?.notificacionesPendientes || 0 }}</p>
            <a href="#" class="text-yellow-600 text-xs mt-2 hover:underline">Ver todo</a>
          </div>
        </div>
      </section>

      <section class="mb-8 p-6 bg-white rounded-md shadow-sm ">
        <h3 class="text-xl font-semibold text-gray-700 mb-6">Última Actividad</h3>
        <div class="space-y-4">
          <div class="flex items-start gap-3 p-4 rounded-md border border-gray-100">
            <p-avatar icon="pi pi-check-circle" styleClass="bg-green-100 text-green-600 flex-shrink-0" shape="circle"></p-avatar>
            <div>
              <p class="text-gray-800 font-medium text-sm">Pedido #2024-06-25 completado</p>
              <p class="text-gray-500 text-xs">Hace 2 días - Producto: Bicicleta de montaña</p>
            </div>
          </div>
          <div class="flex items-start gap-3 p-4 rounded-md border border-gray-100">
            <p-avatar icon="pi pi-comment" styleClass="bg-purple-100 text-purple-600 flex-shrink-0" shape="circle"></p-avatar>
            <div>
              <p class="text-gray-800 font-medium text-sm">Has dejado una reseña para "Casco Urbano"</p>
              <p class="text-gray-500 text-xs">Hace 5 días</p>
            </div>
          </div>
          <div class="flex items-start gap-3 p-4 rounded-md border border-gray-100">
            <p-avatar icon="pi pi-star" styleClass="bg-orange-100 text-orange-600 flex-shrink-0" shape="circle"></p-avatar>
            <div>
              <p class="text-gray-800 font-medium text-sm">Nueva oferta exclusiva disponible</p>
              <p class="text-gray-500 text-xs">Hoy - Descuento del 15% en accesorios</p>
            </div>
          </div>
          <a href="#" class="block text-blue-600 text-sm mt-4 hover:underline text-center">Ver toda la actividad</a>
        </div>
      </section>
    </div>
  </div>
</section>