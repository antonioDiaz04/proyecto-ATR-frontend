<div class="w-full h-max p-3 sm:p-6 font-sans rounded-lg shadow-sm">
  <!-- Header con pestañas - Responsivo -->
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 pb-4 border-b border-gray-200">
    <h2 class="text-lg sm:text-xl font-semibold text-gray-700 flex items-center mb-3 sm:mb-0">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
      </svg>
      Notificaciones
    </h2>

    <!-- Pestañas - Ahora se envuelven en móvil -->
    <div class="flex flex-wrap gap-2 sm:space-x-4">
      <button *ngFor="let tab of tabs" [class.border-b-2]="activeTab === tab.id"
        [class.border-indigo-500]="activeTab === tab.id" [class.text-indigo-600]="activeTab === tab.id"
        [class.text-gray-500]="activeTab !== tab.id" 
        class="px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm font-medium focus:outline-none"
        (click)="activeTab = tab.id">
        {{tab.name}}
      </button>
    </div>
  </div>

  <!-- Contador y acciones - Responsivo -->
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0">
    <p class="text-xs sm:text-sm text-gray-500">
      Mostrando {{filteredNotifications.length}} de {{notifications.length}} notificaciones
    </p>
    <div class="flex space-x-2">
      <button (click)="markAllAsRead()" class="text-xs sm:text-sm text-indigo-600 hover:text-indigo-800 flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 sm:h-4 w-3 sm:w-4 mr-1" fill="none" viewBox="0 0 24 24"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
        Marcar todas como leídas
      </button>
    </div>
  </div>

  <!-- Lista de notificaciones -->
  <ul class="space-y-3">
    <li *ngFor="let notification of filteredNotifications"
      class="relative p-3 sm:p-5 rounded-lg border border-gray-200 hover:border-indigo-200 bg-white hover:shadow-xs transition-all"
      [class.bg-gray-50]="notification.read" [class.border-indigo-300]="!notification.read">

      <!-- Punto de no leído -->
      <div *ngIf="!notification.read" class="absolute top-3 sm:top-4 right-3 sm:right-4 h-2 w-2 bg-indigo-500 rounded-full"></div>

      <!-- Cabecera de notificación - Responsiva -->
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2 sm:gap-0 mb-2">
        <div class="flex items-start">
          <!-- Icono según tipo -->
          <span class="flex items-center justify-center h-7 sm:h-8 w-7 sm:w-8 rounded-full mr-2 sm:mr-3 bg-indigo-100 text-indigo-600">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 sm:h-4 w-3 sm:w-4" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                [attr.d]="getNotificationIcon(notification.type)" />
            </svg>
          </span>
          <div>
            <h3 class="font-medium text-sm sm:text-base text-gray-800">{{ notification.title }}</h3>
            <p *ngIf="notification.customer" class="text-xs text-gray-500">
              Cliente: {{ notification.customer }}
            </p>
          </div>
        </div>
        <span class="text-xs text-gray-400">{{ notification.date | date:'short' }}</span>
      </div>

      <!-- Cuerpo de notificación -->
      <div class="pl-9 sm:pl-11">
        <p class="text-gray-600 text-xs sm:text-sm mb-3">{{ notification.message }}</p>

        <!-- Detalles adicionales - Ajustado para móvil -->
        <div class="flex flex-wrap gap-1 sm:gap-2 mb-3">
          <div *ngIf="notification.product" class="text-xs px-2 py-1 bg-gray-100 rounded-full text-gray-700">
            {{ notification.product }}
          </div>

          <div *ngIf="notification.rating"
            class="flex items-center text-xs px-2 py-1 bg-amber-50 rounded-full text-amber-700">
            <span class="mr-1">Valoración:</span>
            <span class="text-amber-500">
              {{'★'.repeat(notification.rating) + '☆'.repeat(5 - notification.rating)}}
            </span>
          </div>

          <div *ngIf="notification.price" class="text-xs px-2 py-1 bg-green-50 rounded-full text-green-700">
            ${{ notification.price | number:'1.2-2' }}
          </div>

          <div *ngIf="notification.dueDate" class="text-xs px-2 py-1 bg-blue-50 rounded-full text-blue-700">
            Vence: {{ notification.dueDate | date:'shortDate' }}
          </div>
        </div>

        <!-- Estado -->
        <div *ngIf="notification.status" class="inline-block">
          <span class="text-xs px-2 py-1 rounded-full font-medium" [ngClass]="getStatusColor(notification.status)">
            {{ notification.status | titlecase }}
          </span>
        </div>

        <!-- Acciones - Ajustadas para móvil -->
        <div class="mt-3 sm:mt-4 flex flex-wrap gap-2 sm:gap-3 border-t border-gray-100 pt-3">
          <button (click)="markAsRead(notification.id)"
            class="text-xs text-indigo-600 hover:text-indigo-800 font-medium">
            {{ notification.read ? '✓ Leída' : 'Marcar como leída' }}
          </button>
          <button (click)="deleteNotification(notification.id)"
            class="text-xs text-gray-500 hover:text-gray-700 font-medium flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
            Eliminar
          </button>
        </div>
      </div>
    </li>
  </ul>

  <!-- Mensaje cuando no hay notificaciones -->
  <div *ngIf="filteredNotifications.length == 0" class="text-center py-8 sm:py-10 text-gray-500">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 sm:h-12 w-10 sm:w-12 mx-auto text-gray-300" fill="none" viewBox="0 0 24 24"
      stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
        d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
    </svg>
    <p class="mt-2 text-sm sm:text-base">No hay notificaciones en esta categoría</p>
  </div>
</div>

<!-- Sección de vinculación de dispositivo - Responsiva -->
<div class="w-full h-max p-3 sm:p-6 font-sans rounded-lg shadow-sm bg-white mt-4 sm:mt-6">
  <div class="mb-6 sm:mb-8 p-3 sm:p-5 border border-gray-200 rounded-lg bg-gray-50">
    <h3 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3 flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
      </svg>
      Vincular Dispositivo Wear OS
    </h3>

    <p class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4">
      Escanea el código QR de tu dispositivo wearable para vincularlo con tu cuenta y recibir notificaciones.
    </p>

    <button (click)="activarScanner()"
      class="flex items-center px-3 sm:px-4 py-1.5 sm:py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs sm:text-sm rounded-lg transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 sm:h-5 w-4 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
      {{scannerActivo ? 'Cancelar escaneo' : 'Iniciar escáner QR'}}
    </button>

    <!-- Mensaje de estado -->
    <div *ngIf="vincularMensaje" class="mt-2 sm:mt-3 p-2 sm:p-3 rounded-md" [class.bg-green-100]="vincularExito"
      [class.bg-red-100]="!vincularExito">
      <p class="text-xs sm:text-sm flex items-center" [class.text-green-800]="vincularExito" [class.text-red-800]="!vincularExito">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 sm:h-4 w-3 sm:w-4 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            [attr.d]="vincularExito ? 'M5 13l4 4L19 7' : 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'" />
        </svg>
        {{ vincularMensaje }}
      </p>
    </div>
  </div>

  <!-- Área del escáner - Responsiva -->
  <div *ngIf="scannerActivo"
    class="mt-4 sm:mt-6 p-2 sm:p-4 border-2 border-dashed border-gray-300 rounded-lg bg-black relative overflow-hidden">
    <div class="absolute inset-0 flex items-center justify-center z-10 pointer-events-none">
      <div class="border-4 border-blue-500 rounded-lg"
        style="width: 80%; max-width: 400px; height: 50vh; min-height: 300px; max-height: 400px;"></div>
    </div>

    <zxing-scanner class="w-full h-[50vh] min-h-[300px] max-h-[400px] object-cover" (scanSuccess)="onCodeResult($event)"
      [enable]="scannerActivo">
    </zxing-scanner>

    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white text-center py-2 sm:py-3 text-xs sm:text-sm">
      Escanea el código QR de tu dispositivo Wear OS
    </div>
  </div>

  <!-- Instrucciones cuando el escáner no está activo - Responsivo -->
  <div *ngIf="!scannerActivo" class="mt-4 sm:mt-6 p-3 sm:p-5 bg-gray-50 rounded-lg border border-gray-200">
    <h4 class="font-medium text-sm sm:text-base text-gray-700 mb-2">¿Cómo vincular tu dispositivo?</h4>
    <ol class="list-decimal list-inside text-xs sm:text-sm text-gray-600 space-y-1 sm:space-y-2">
      <li>Abre la aplicación Wear OS en tu dispositivo</li>
      <li>Ve a Configuración → Vincular con web</li>
      <li>Selecciona "Generar código QR"</li>
      <li>Haz clic en "Iniciar escáner QR" arriba</li>
      <li>Apunta la cámara hacia el código QR</li>
    </ol>
    <div class="mt-3 sm:mt-4 p-2 sm:p-3 bg-blue-50 rounded border border-blue-100 text-xs sm:text-sm text-blue-800">
      <p>💡 Consejo: Asegúrate de que el código QR esté bien iluminado y ocupe la mayor parte del marco de escaneo.</p>
    </div>
  </div>
</div>